@{
    ViewData["Title"] = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

@model List<ProjectIMDB.Models.VM.MovieVM>
    <!-- Favicon icon -->
<link rel="icon" type="image/png" sizes="16x16" href="/Adminsite/assets/images/favicon.png">
<title>Matrix Template - The Ultimate Multipurpose admin template</title>
<!-- Custom CSS -->
<link href="/Adminsite/assets/libs/fullcalendar/dist/fullcalendar.min.css" rel="stylesheet" />
<link href="/Adminsite/assets/extra-libs/calendar/calendar.css" rel="stylesheet" />
<link href="/Adminsite/dist/css/style.min.css" rel="stylesheet">


<link rel="stylesheet" type="text/css" href="/Adminsite/assets/extra-libs/multicheck/multicheck.css">
<link href="/Adminsite/assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.css" rel="stylesheet">
<div class="page-breadcrumb">
    <div class="row">
        <div class="col-12 d-flex no-block align-items-center">
            <h4 class="page-title">Movie List</h4>
            <div class="ml-auto text-right">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Movie</a></li>
                        <li class="breadcrumb-item active" aria-current="page">List</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div id="asdf"></div>
                    <h5 class="card-title">Basic Datatable</h5>
                    <div class="table-responsive">
                        <table id="zero_config" class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    @*<th>Poster</th>*@
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Duration</th>
                                    <th>Release Date</th>
                                    <th>Add Date</th>
                                    <th>Update Date</th>
                                    <th>Genre</th>
                                    <th>Directors</th>
                                    <th>Scenarists</th>
                                    <th>Stars</th>
                                    <th>Edit</th>
                                    <th>Delete</th>
                                    @*<th>Detail</th>*@

                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr id="@item.id">
                                        @*<td><img width="100" height="150" src="/adminsite/movieposter/@item.posterurl" alt="Alternate Text" /></td>*@
                                        <td>@item.id</td>
                                        <td>@item.name</td>
                                        <td>@item.duration</td>
                                        <td>@item.releasedate.ToString("dd MMMM yyyy")</td>
                                        <td>@item.adddate</td>
                                        <td>@item.updatedate</td>
                                        <td>
                                            @foreach (var genre in item.moviegenres)
                                            {
                                                <span>@genre.Genre.Name/</span>
                                            }

                                        </td>

                                        <td>
                                            @foreach (var director in item.moviepeople.Where(q => q.JobID == 1))
                                            {
                                                <span>@director.Person.Name @director.Person.SurName /</span>
                                            }

                                        </td>


                                        <td>
                                            @foreach (var scenarist in item.moviepeople.Where(q => q.JobID == 2))
                                            {
                                                <span>@scenarist.Person.Name @scenarist.Person.SurName /</span>
                                            }

                                        </td>


                                        <td>
                                            @foreach (var star in item.moviepeople.Where(q => q.JobID == 3))
                                            {
                                                <span>@star.Person.Name @star.Person.SurName /</span>
                                            }

                                        </td>
                                        <td><a href="/Movie/Edit/@item.id"><button type="submit" class="btn btn-outline-warning">Edit</button></a></td>
                                        <td><button id="@item.id" class="btn btn-outline-danger delete">Delete</button></td>
                                        @*<td>
                                                <a href="javascript:void(0)" id="@item.id" data-toggle="modal" data-target="#add-new-event" class="btn m-t-20 btn-info btn-block waves-effect waves-light detail">
                                                    Detail

                                                </a>
                                            </td>*@

                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Container fluid  -->
<!-- ============================================================== -->
@*<div class="container-fluid">

    </div>*@

<!-- Modal Add Category -->
@*<div class="modal fade none-border" id="add-new-event">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title"><strong>Film Crew</strong></h2>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-md-6">
                            <h3>Scenarists</h3>
                            <p id="scenarist"></p>


                        </div>

                        <div class="col-md-6">
                            <h3>Stars</h3>
                            <p id="stars"></p>


                        </div>

                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary waves-effect" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>*@
<!-- END MODAL -->
<!-- ============================================================== -->
<!-- End PAge Content -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- End Container fluid  -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<script src="/Adminsite/assets/libs/jquery/dist/jquery.min.js"></script>
<script src="/Adminsite/dist/js/jquery.ui.touch-punch-improved.js"></script>
<script src="/Adminsite/dist/js/jquery-ui.min.js"></script>
<!-- Bootstrap tether Core JavaScript -->
<script src="/Adminsite/assets/libs/popper.js/dist/umd/popper.min.js"></script>
<script src="/Adminsite/assets/libs/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- slimscrollbar scrollbar JavaScript -->
<script src="/Adminsite/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js"></script>
<script src="/Adminsite/assets/extra-libs/sparkline/sparkline.js"></script>
<!--Wave Effects -->
<script src="/Adminsite/dist/js/waves.js"></script>
<!--Menu sidebar -->
<script src="/Adminsite/dist/js/sidebarmenu.js"></script>
<!--Custom JavaScript -->
<script src="/Adminsite/dist/js/custom.min.js"></script>
<!-- this page js -->
<script src="/Adminsite/assets/libs/moment/min/moment.min.js"></script>
<script src="/Adminsite/assets/libs/fullcalendar/dist/fullcalendar.min.js"></script>
<script src="/Adminsite/dist/js/pages/calendar/cal-init.js"></script>


<script src="/Adminsite/assets/extra-libs/multicheck/datatable-checkbox-init.js"></script>
<script src="/Adminsite/assets/extra-libs/multicheck/jquery.multicheck.js"></script>
<script src="/Adminsite/assets/extra-libs/DataTables/datatables.min.js"></script>
<script>
    $(function () {
        $('#zero_config').DataTable();

        $(document).on("click", ".delete", function () {
            let id = $(this).attr("id");
            $.ajax({
                url: "/Movie/Delete",
                type: "POST",
                data: { id: id },
                success: function (msg) {
                    $("#" + id).fadeOut();
                    alert("Deleted");
                },
                error: function (err) {
                    alert("Failed")
                }
            })
        });

        //$(document).on("click", ".detail", function () {
        //    let id = $(this).attr("id");
        //    fetch("/Movie/Detail/" + id)
        //        .then((res) => res.json())
        //        .then((result) => {
        //            console.log(result);
        //            //        $("#scenarist").html(result.);
        //            //        $("#eklenmetarih").html(result.addDate);
        //            //        //$("#baslik").html(result.title);
        //        })
        //    //$("#detailmodal").modal();
        //})
    });
</script>